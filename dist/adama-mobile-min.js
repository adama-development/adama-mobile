"use strict";angular.module("adama-mobile",["ionic","pascalprecht.translate","ngCookies","ngResource","LocalStorageModule","ngMessages"]),angular.module("adama-mobile").run(["$ionicPlatform",function(t){t.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),angular.module("adama-mobile").config(["$urlRouterProvider",function(t){t.otherwise("/app/")}]),angular.module("adama-mobile").config(["$translateProvider",function(t){t.useSanitizeValueStrategy("escapeParameters"),t.useLocalStorage(),t.registerAvailableLanguageKeys(["en","fr"],{"en_*":"en","fr_*":"fr"}),t.determinePreferredLanguage().fallbackLanguage("en")}]),angular.module("adama-mobile").config(["$stateProvider","jHipsterConstant",function(t,e){t.state("app",{"abstract":!0,url:"/app",templateUrl:function(){return e.adamaMobileToolkitTemplateUrl.app},resolve:{authorize:["Auth",function(t){return t.authorize()}]}})}]),angular.module("adama-mobile").run(["$rootScope","pageTitle",function(t,e){t.$on("$stateChangeSuccess",function(t,a){a&&a.data&&a.data.pageTitle&&e.set(a.data.pageTitle)})}]),angular.module("adama-mobile").run(["$rootScope",function(t){t.$on("$stateChangeError",function(t,e,a,n,r,o){throw o})}]),angular.module("adama-mobile").controller("AccessDeniedCtrl",function(){}),angular.module("adama-mobile").config(["$stateProvider","jHipsterConstant",function(t,e){t.state("auth",{"abstract":!0,url:"/auth",template:"<ui-view></ui-view>"}),t.state("auth.signin",{url:"/",templateUrl:function(){return e.adamaMobileToolkitTemplateUrl.authSignin},controller:"SigninCtrl",controllerAs:"ctrl",data:{pageTitle:"SIGNIN",authorities:[]}}),t.state("auth.accessDenied",{url:"/accessDenied",templateUrl:function(){return e.adamaMobileToolkitTemplateUrl.authAccessDenied},controller:"AccessDeniedCtrl",controllerAs:"ctrl",data:{pageTitle:"ACCESS_DENIED",authorities:[]}})}]),angular.module("adama-mobile").config(["$translateProvider",function(t){t.translations("fr",{SIGNIN:"Identification",SIGNIN_INTRO:"Identifiez-vous pour démarrer votre session",SIGNIN_FORGET_PASSWORD:"J'ai oublié mon mot de passe ...",SIGNIN_USERNAME:"Identifiant",SIGNIN_USERNAME_REQUIRED:"L'identifiant est obligatoire",SIGNIN_PASSWORD:"Mot de passe",SIGNIN_PASSWORD_REQUIRED:"Le mot de passe est obligatoire",SIGNIN_SUBMIT:"Démarrer la session",SIGNIN_ERROR_TITLE:"Erreur d'authentification",SIGNIN_ERROR_MESSAGE:"Identifiant ou mot de passe incorrect.",ACCESS_DENIED_BACK_TO_HOME:"Retour à l'accueil",ACCESS_DENIED:"Accès interdit",ACCESS_DENIED_INTRO:"Vous n'avez pas suffisamment de droits d'accéder à cette page."}),t.translations("en",{SIGNIN:"Signin",SIGNIN_INTRO:"Sign in to start your session",SIGNIN_FORGET_PASSWORD:"I forgot my password ...",SIGNIN_USERNAME:"Username",SIGNIN_USERNAME_REQUIRED:"Username is required",SIGNIN_PASSWORD:"Password",SIGNIN_PASSWORD_REQUIRED:"Password is required",SIGNIN_SUBMIT:"Start session",SIGNIN_ERROR_TITLE:"Authentication error",SIGNIN_ERROR_MESSAGE:"Username or password are incorrect.",RECOVER_SUBMIT:"Retrieve my password",ACCESS_DENIED_BACK_TO_HOME:"Back to home",ACCESS_DENIED:"Access denied",ACCESS_DENIED_INTRO:"You do not have enough privileges to access this page."})}]),angular.module("adama-mobile").controller("SigninCtrl",["$rootScope","$state","Auth","$filter","$ionicPopup",function(t,e,a,n,r){var o=this;o.signin=function(o,i){a.login({username:o,password:i}).then(function(){"auth.signin"===t.previousStateName?e.go("app.main"):t.back()})["catch"](function(){var t=n("translate");r.alert({title:t("SIGNIN_ERROR_TITLE"),template:t("SIGNIN_ERROR_MESSAGE")})})}}]),angular.module("adama-mobile").config(["$translateProvider",function(t){t.translations("fr",{BTN_SIGNOUT:"Déconnexion"}),t.translations("en",{BTN_SIGNOUT:"Sign out"})}]),angular.module("adama-mobile").directive("btnSignout",function(){return{templateUrl:"adama-mobile/btn-signout/btn-signout.html",restrict:"E",scope:{},bindToController:{},controller:["Auth","$state",function(t,e){var a=this;a.signout=function(){t.logout(),e.go("auth.signin")}}],controllerAs:"ctrl"}}),angular.module("adama-mobile").directive("dsLanguage",["$parse","language",function(t,e){return{scope:!1,link:function(a,n,r){e.getAll().then(function(e){t(r.data).assign(a,e)})}}}]),angular.module("adama-mobile").directive("dsPrincipalIdentity",["$parse","Principal",function(t,e){return{scope:!1,link:function(a,n,r){e.identity().then(function(e){t(r.data).assign(a,e)})}}}]),angular.module("adama-mobile").run(["$rootScope","$state","Principal","Auth",function(t,e,a,n){t.$on("$stateChangeStart",function(e,r,o){t.toState=r,t.toStateParams=o,a.isIdentityResolved()&&n.authorize()}),t.$on("$stateChangeSuccess",function(e,a,n,r,o){"auth.signin"!==a.name&&t.previousStateName&&(t.previousStateName=r.name,t.previousStateParams=o)}),t.back=function(){null===e.get(t.previousStateName)?e.go("app.main"):e.go(t.previousStateName,t.previousStateParams)}}]),angular.module("adama-mobile").config(["$httpProvider",function(t){t.interceptors.push("authExpiredInterceptor"),t.interceptors.push("authInterceptor")}]),angular.module("adama-mobile").constant("jHipsterConstant",{apiBase:"http://localhost:13337/",appModule:"mySuperApp",adamaMobileToolkitTemplateUrl:{app:"adama-mobile/app.html",authAccessDenied:"adama-mobile/auth/accessDenied.html",authSignin:"adama-mobile/auth/signin.html"}}),angular.module("adama-mobile").factory("jHipsterResourceConfig",["ParseLinks",function(t){return{query:{method:"GET",isArray:!0,transformResponse:function(e,a,n){return e=angular.fromJson(e),200===n&&(e.$metadata={links:t.parse(a("link")),totalItems:a("X-Total-Count")}),e},interceptor:{response:function(t){return t.resource.$metadata=t.data.$metadata,t.resource}}},get:{method:"GET"},save:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE",params:{id:"@id"}}}}]),angular.module("adama-mobile").factory("User",["$resource","jHipsterConstant","jHipsterResourceConfig",function(t,e,a){var n=angular.extend({},a,{"delete":{method:"DELETE",params:{login:"@login"}}});return t(e.apiBase+"api/users/:login",{},n)}]),angular.module("adama-mobile").provider("language",function(){var t=["en","fr"],e=[{code:"en",labelKey:"FLAG_EN",cssCLass:"us"},{code:"fr",labelKey:"FLAG_FR",cssCLass:"fr"}];this.setLanguages=function(e){t=e},this.setSelectorData=function(t){e=t},this.$get=["$q","$http","$translate",function(a,n,r){var o={};return o.getCurrent=function(){var t=r.storage().get("NG_TRANSLATE_LANG_KEY");return angular.isUndefined(t)&&(t="en"),a.when(t)},o.getAll=function(){return a.when(t)},o.getSelectorData=function(){return a.when(e)},o}]}),angular.module("adama-mobile").factory("pageTitle",["$rootScope","$filter",function(t,e){var a=e("translate"),n={};return n.set=function(e){var n=a(e);t.pageTitle=n},n}]),angular.module("adama-mobile").directive("jhAlert",["AlertService",function(t){return{restrict:"E",template:'<div class="content-wrapper" ng-cloak ng-if="alerts && alerts.length"><div class="box-body"><div ng-repeat="alert in alerts" class="alert alert-dismissible" ng-class="\'alert-\' + alert.type"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>{{ alert.msg }}</div></div></div>',controller:["$scope",function(e){e.alerts=t.get(),e.$on("$destroy",function(){e.alerts=[]})}]}}]).directive("jhAlertError",["AlertService","$rootScope","$translate",function(t,e,a){return{restrict:"E",template:'<div class="alerts" ng-if="alerts && alerts.length"><div ng-repeat="alert in alerts" class="alert alert-dismissible" ng-class="\'alert-\' + alert.type"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>{{ alert.msg }}</div></div>',controller:["$scope","jHipsterConstant",function(n,r){n.alerts=[];var o=function(e,a,r){a=a&&null!==a?a:e,n.alerts.push(t.add({type:"danger",msg:a,params:r,timeout:5e3,toast:t.isToast(),scoped:!0},n.alerts))},i=e.$on(r.appModule+".httpError",function(t,e){var n;switch(t.stopPropagation(),e.status){case 0:o("Server not reachable","error.server.not.reachable");break;case 400:var i=e.headers("X-"+r.appModule+"-error"),s=e.headers("X-"+r.appModule+"-params");if(i){var u=a.instant("global.menu.entities."+s);o(i,i,{entityName:u})}else if(e.data&&e.data.fieldErrors)for(n=0;n<e.data.fieldErrors.length;n++){var l=e.data.fieldErrors[n],c=l.field.replace(/\[\d*\]/g,"[]"),d=a.instant(r.appModule+"."+l.objectName+"."+c);o("Field "+d+" cannot be empty","error."+l.message,{fieldName:d})}else e.data&&e.data.message?o(e.data.message,e.data.message,e.data):o(e.data);break;default:o(e.data&&e.data.message?e.data.message:JSON.stringify(e))}});n.$on("$destroy",function(){void 0!==i&&null!==i&&(i(),n.alerts=[])})}]}}]),angular.module("adama-mobile").provider("AlertService",function(){var t=!1;this.$get=["$timeout","$sce","$translate",function(e,a,n){var r=0,o=[],i=5e3,s=function(){return t},u=function(){o=[]},l=function(){return o},c=function(t,e){return e.splice(t,1)},d=function(t,e){var a=e?e:o;return c(a.map(function(t){return t.id}).indexOf(t),a)},m=function(t){var e={type:t.type,msg:a.trustAsHtml(t.msg),id:t.alertId,timeout:t.timeout,toast:t.toast,position:t.position?t.position:"top right",scoped:t.scoped,close:function(t){return d(this.id,t)}};return e.scoped||o.push(e),e},p=function(t,a){t.alertId=r++,t.msg=n.instant(t.msg,t.params);var o=m(t);return t.timeout&&t.timeout>0&&e(function(){d(t.alertId,a)},t.timeout),o},f=function(e,a,n){return p({type:"success",msg:e,params:a,timeout:i,toast:t,position:n})},g=function(e,a,n){return p({type:"danger",msg:e,params:a,timeout:i,toast:t,position:n})},h=function(e,a,n){return p({type:"warning",msg:e,params:a,timeout:i,toast:t,position:n})},S=function(e,a,n){return p({type:"info",msg:e,params:a,timeout:i,toast:t,position:n})};return{factory:m,isToast:s,add:p,closeAlert:d,closeAlertByIndex:c,clear:u,get:l,success:f,error:g,info:S,warning:h}}],this.showAsToast=function(e){t=e}}),angular.module("adama-mobile").service("Base64",function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(e){for(var a,n,r,o,i,s="",u="",l="",c=0;c<e.length;)a=e.charCodeAt(c++),n=e.charCodeAt(c++),u=e.charCodeAt(c++),r=a>>2,o=(3&a)<<4|n>>4,i=(15&n)<<2|u>>6,l=63&u,isNaN(n)?i=l=64:isNaN(u)&&(l=64),s=s+t.charAt(r)+t.charAt(o)+t.charAt(i)+t.charAt(l),a=n=u="",r=o=i=l="";return s},this.decode=function(e){var a,n,r,o,i,s="",u="",l="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)r=t.indexOf(e.charAt(c++)),o=t.indexOf(e.charAt(c++)),i=t.indexOf(e.charAt(c++)),l=t.indexOf(e.charAt(c++)),a=r<<2|o>>4,n=(15&o)<<4|i>>2,u=(3&i)<<6|l,s+=String.fromCharCode(a),64!==i&&(s+=String.fromCharCode(n)),64!==l&&(s+=String.fromCharCode(u)),a=n=u="",r=o=i=l=""}}).factory("StorageService",["$window",function(t){return{get:function(e){return JSON.parse(t.localStorage.getItem(e))},save:function(e,a){t.localStorage.setItem(e,JSON.stringify(a))},remove:function(e){t.localStorage.removeItem(e)},clearAll:function(){t.localStorage.clear()}}}]),angular.module("adama-mobile").service("ParseLinks",function(){this.parse=function(t){if(0===t.length)throw new Error("input must not be of zero length");var e=t.split(","),a={};return angular.forEach(e,function(t){var e=t.split(";");if(2!==e.length)throw new Error('section could not be split on ";"');var n=e[0].replace(/<(.*)>/,"$1").trim(),r={};n.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(t,e,a,n){r[e]=n});var o=r.page;angular.isString(o)&&(o=parseInt(o));var i=e[1].replace(/rel='(.*)'/,"$1").trim();a[i]=o}),a}}),angular.module("adama-mobile").factory("authInterceptor",["$rootScope","$q","$location","localStorageService",function(t,e,a,n){return{request:function(t){t.headers=t.headers||{};var e=n.get("token");return e&&e.expires&&e.expires>(new Date).getTime()&&(t.headers["x-auth-token"]=e.token),t}}}]).factory("authExpiredInterceptor",["$rootScope","$q","$injector","localStorageService",function(t,e,a,n){return{responseError:function(t){if(401===t.status&&("invalid_token"===t.data.error||"Unauthorized"===t.data.error)){n.remove("token");var r=a.get("Principal");if(r.isAuthenticated()){var o=a.get("Auth");o.authorize(!0)}}return e.reject(t)}}}]),angular.module("adama-mobile").factory("errorHandlerInterceptor",["$q","$rootScope","jHipsterConstant",function(t,e,a){return{responseError:function(n){return 401===n.status&&0===n.data.path.indexOf("/api/account")||e.$emit(a.appModule+".httpError",n),t.reject(n)}}}]),angular.module("adama-mobile").factory("notificationInterceptor",["$q","AlertService","jHipsterConstant",function(t,e,a){return{response:function(t){var n=t.headers("X-"+a.appModule+"-alert");return angular.isString(n)&&e.success(n,{param:t.headers("X-"+a.appModule+"-params")}),t}}}]),angular.module("adama-mobile").factory("Auth",["$rootScope","$state","$q","$translate","Principal","AuthServerProvider","Account","Password","PasswordResetInit","PasswordResetFinish",function(t,e,a,n,r,o,i,s,u,l){return{login:function(t,e){var i=e||angular.noop,s=a.defer();return o.login(t).then(function(t){return r.identity(!0).then(function(e){n.use(e.langKey),s.resolve(t)}),i()})["catch"](function(t){return this.logout(),s.reject(t),i(t)}.bind(this)),s.promise},logout:function(){o.logout(),r.authenticate(null),t.previousStateName=void 0,t.previousStateNameParams=void 0},authorize:function(a){return r.identity(a).then(function(){var a=r.isAuthenticated();a&&t.toState.name&&"auth.signin"===t.toState.name&&e.go("app.main"),t.toState.data&&t.toState.data.authorities||a?t.toState.data&&t.toState.data.authorities&&t.toState.data.authorities.length>0&&!r.hasAnyAuthority(t.toState.data.authorities)&&(a?e.go("auth.accessDenied"):(t.previousStateName=t.toState,t.previousStateNameParams=t.toStateParams,e.go("auth.signin"))):e.go("auth.signin")})},updateAccount:function(e,a){var n=a||angular.noop;return i.save(e,function(){return t.$emit("auth.updateAccount",{account:e}),n(e)},function(t){return n(t)}.bind(this)).$promise},changePassword:function(t,e){var a=e||angular.noop;return s.save(t,function(){return a()},function(t){return a(t)}).$promise},resetPasswordInit:function(t,e){var a=e||angular.noop;return u.save(t,function(){return a()},function(t){return a(t)}).$promise},resetPasswordFinish:function(t,e){var a=e||angular.noop;return l.save(t,function(){return a()},function(t){return a(t)}).$promise}}}]),angular.module("adama-mobile").directive("hasAnyAuthority",["Principal",function(t){return{restrict:"A",link:function(e,a,n){var r=function(){a.removeClass("hidden")},o=function(){a.addClass("hidden")},i=n.hasAnyAuthority.replace(/\s+/g,"").split(","),s=function(e){var a;e&&r(),a=t.hasAnyAuthority(i),a?r():o()};i.length>0&&(s(!0),e.$watch(function(){return t.isAuthenticated()},function(){s(!0)}))}}}]).directive("hasAuthority",["Principal",function(t){return{restrict:"A",link:function(e,a,n){var r=function(){a.removeClass("hidden")},o=function(){a.addClass("hidden")},i=n.hasAuthority.replace(/\s+/g,""),s=function(e){e&&r(),t.hasAuthority(i).then(function(t){t?r():o()})};i.length>0&&(s(!0),e.$watch(function(){return t.isAuthenticated()},function(){s(!0)}))}}}]),angular.module("adama-mobile").factory("Principal",["$q","Account",function(t,e){var a,n=!1;return{isIdentityResolved:function(){return angular.isDefined(a)},isAuthenticated:function(){return n},hasAuthority:function(e){return n?this.identity().then(function(t){return t.authorities&&-1!==t.authorities.indexOf(e)},function(){return!1}):t.when(!1)},hasAnyAuthority:function(t){if(!n||!a||!a.authorities)return!1;for(var e=0;e<t.length;e++)if(-1!==a.authorities.indexOf(t[e]))return!0;return!1},authenticate:function(t){a=t,n=null!==t},identity:function(r){var o=t.defer();return r===!0&&(a=void 0),angular.isDefined(a)?(o.resolve(a),o.promise):(e.get().$promise.then(function(t){a=t.data,n=!0,o.resolve(a)})["catch"](function(){a=null,n=!1,o.resolve(a)}),o.promise)}}}]),angular.module("adama-mobile").factory("AuthServerProvider",["$http","localStorageService","Base64","jHipsterConstant",function(t,e,a,n){return{login:function(a){var r="username="+encodeURIComponent(a.username)+"&password="+encodeURIComponent(a.password);return t.post(n.apiBase+"api/authenticate",r,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}}).success(function(t){return e.set("token",t),t})},logout:function(){e.clearAll()},getToken:function(){return e.get("token")},hasValidToken:function(){var t=this.getToken();return t&&t.expires&&t.expires>(new Date).getTime()}}}]),angular.module("adama-mobile").factory("Account",["$resource","jHipsterConstant",function(t,e){return t(e.apiBase+"api/account",{},{get:{method:"GET",params:{},isArray:!1,interceptor:{response:function(t){return t}}}})}]),angular.module("adama-mobile").factory("Password",["$resource","jHipsterConstant",function(t,e){return t(e.apiBase+"api/account/change_password",{},{})}]),angular.module("adama-mobile").factory("PasswordResetInit",["$resource","jHipsterConstant",function(t,e){return t(e.apiBase+"api/account/reset_password/init",{},{})}]),angular.module("adama-mobile").factory("PasswordResetFinish",["$resource","jHipsterConstant",function(t,e){return t(e.apiBase+"api/account/reset_password/finish",{},{})}]);
//# sourceMappingURL=adama-mobile-min.js.map
