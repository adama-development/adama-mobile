{"version":3,"sources":["app.js","app-config.js","auth/accessDenied.controller.js","auth/app.js","auth/recoverPassword.controller.js","auth/signin.controller.js","btn-signout/app.js","btn-signout/btn-signout.directive.js","datasources/binary-file-url.datasource.js","datasources/language.datasource.js","datasources/principal-identity.datasource.js","interceptors/auth-expired.interceptor.js","interceptors/auth.interceptor.js","resources/user.resource.js","services/adama-resource-config.service.js","services/adama-token.service.js","services/adama.constant.js","services/auth.service.js","services/binary-file.service.js","services/language.provider.js","services/loading.service.js","services/notifications.service.js","services/page-title.service.js","services/parse-links.service.js","services/principal.service.js"],"names":["angular","module","run","$ionicPlatform","ready","window","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","disableScroll","StatusBar","styleDefault","config","$urlRouterProvider","otherwise","$injector","$state","get","go","$translateProvider","useSanitizeValueStrategy","useLocalStorage","registerAvailableLanguageKeys","en_*","fr_*","determinePreferredLanguage","fallbackLanguage","$stateProvider","adamaConstant","state","abstract","url","templateUrl","adamaMobileToolkitTemplateUrl","app","$rootScope","pageTitle","$on","event","toState","data","set","$httpProvider","interceptors","push","principalService","authorities","length","isAuthenticated","hasAnyAuthority","toParams","fromState","fromParams","error","$cordovaBadge","enableBadge","on","clear","$log","$ionicPush","$ionicUser","log","getInstance","enablePush","init","debug","onNotification","notification","$apply","payload","getPayload","asleep","closed","onRegister","token","canShowAlert","canSetBadge","canPlaySound","canRunActionsOnWake","current","register","saveToken","unregister","logEnhancerProvider","prefixPattern","datetimePattern","logLevels","*","LEVEL","OFF","controller","template","authSignin","controllerAs","authRecover","authAccessDenied","translations","SIGNIN","SIGNIN_INTRO","SIGNIN_FORGET_PASSWORD","SIGNIN_USERNAME","SIGNIN_USERNAME_REQUIRED","SIGNIN_PASSWORD","SIGNIN_PASSWORD_REQUIRED","SIGNIN_SUBMIT","SIGNIN_LOADING","SIGNIN_ERROR_TITLE","SIGNIN_ERROR_MESSAGE","RECOVER","RECOVER_INTRO","RECOVER_MAIL","RECOVER_MAIL_REQUIRED","RECOVER_MAIL_EMAIL","RECOVER_SUBMIT","RECOVER_BACK_TO_LOGIN","RECOVER_SUCCESS","RECOVER_ERROR_TITLE","RECOVER_ERROR_GENERIC","RECOVER_ERROR_EMAIL_NOT_EXIST","ACCESS_DENIED_BACK_TO_HOME","ACCESS_DENIED","ACCESS_DENIED_INTRO","$filter","$ionicPopup","ctrl","this","recover","userEmail","recoverSuccess","recoverError","errorEmailNotExists","loading","resetPasswordInit","then","response","messageKey","status","translateFn","alert","title","authService","signin","userName","userPassword","login","rejection","info","BTN_SIGNOUT","component","signout","logout","directive","$parse","binaryFileService","scope","link","element","attrs","updateOutput","binaryFileList","output","copy","isArray","initUrlForBinaryFiles","assign","$watch","input","language","getAll","languages","principal","undefined","getPrincipal","factory","$q","getHttpService","service","getAdamaTokenService","getStateService","responseError","indexOf","apiBase","refreshAndGetToken","headers","reject","request","getToken","$resource","adamaResourceConfig","extend","delete","method","params","id","ParseLinks","query","transformResponse","fromJson","$metadata","links","parse","totalItems","interceptor","resource","save","update","$http","jwtHelper","api","ionicUser","isTokenExpired","when","JSON","stringify","refreshToken","Authorization","refresh_token","newToken","access_token","constant","urlResetPassword","$ionicAuth","username","password","authOptions","remember","externalId","$broadcast","resetPrincipal","deletePrincipal","workingList","idList","forEach","binaryFile","toJson","urlList","provider","selectorData","code","labelKey","cssCLass","setLanguages","newLanguages","setSelectorData","newSelectorData","$get","$translate","getCurrent","storage","isUndefined","getSelectorData","$ionicLoading","blockUiWhileResolving","promise","$$state","show","hide","$cordovaToast","pageTitleKey","newTitle","header","Error","parts","split","p","section","replace","trim","queryString","RegExp","$0","$1","$2","$3","page","isString","parseInt","name","principalPromise","accountResource","passwordResource","passwordResetInitResource","result","details","mail","$promise","updateAccount","$emit","changePassword","newPassword"],"mappings":"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","file":"adama-mobile-min.js","sourcesContent":["'use strict';\n\nangular.module('adama-mobile', [ //\n\t'ionic', //\n\t'ionic.service.core', //\n\t'ionic.service.auth', //\n\t'ionic.service.deploy', //\n\t'ionic.service.push', //\n\t'pascalprecht.translate', //\n\t'ngCookies', //\n\t'ngResource', //\n\t'LocalStorageModule', //\n\t'ngCordova', //\n\t'angular-jwt', //\n\t'angular-logger', //\n\t'ngMessages' //\n]);\n","/* globals StatusBar:false, cordova: false */\n\n'use strict';\n\nangular.module('adama-mobile').run([\"$ionicPlatform\", function($ionicPlatform) {\n\t$ionicPlatform.ready(function() {\n\t\tif (window.cordova && window.cordova.plugins.Keyboard) {\n\t\t\t// Hide the accessory bar by default (remove this to show the\n\t\t\t// accessory bar above the keyboard for form inputs)\n\t\t\tcordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);\n\n\t\t\t// Don't remove this line unless you know what you are doing. It\n\t\t\t// stops the viewport from snapping when text inputs are focused.\n\t\t\t// Ionic handles this internally for a much nicer keyboard\n\t\t\t// experience.\n\t\t\tcordova.plugins.Keyboard.disableScroll(true);\n\t\t}\n\t\tif (window.StatusBar) {\n\t\t\tStatusBar.styleDefault();\n\t\t}\n\t});\n}]);\n\nangular.module('adama-mobile').config([\"$urlRouterProvider\", function($urlRouterProvider) {\n\t// see https://github.com/angular-ui/ui-router/issues/600#issuecomment-47228922\n\t$urlRouterProvider.otherwise(function($injector) {\n\t\tvar $state = $injector.get('$state');\n\t\t$state.go('app.main');\n\t});\n}]);\n\nangular.module('adama-mobile').config([\"$translateProvider\", function($translateProvider) {\n\t$translateProvider.useSanitizeValueStrategy('escapeParameters');\n\n\t$translateProvider.useLocalStorage();\n\n\t$translateProvider.registerAvailableLanguageKeys(['en', 'fr'], {\n\t\t'en_*': 'en',\n\t\t'fr_*': 'fr'\n\t});\n\n\t$translateProvider.determinePreferredLanguage().fallbackLanguage('en');\n}]);\n\nangular.module('adama-mobile').config([\"$stateProvider\", \"adamaConstant\", function($stateProvider, adamaConstant) {\n\t$stateProvider.state('app', {\n\t\tabstract: true,\n\t\turl: '/app',\n\t\ttemplateUrl: function() {\n\t\t\treturn adamaConstant.adamaMobileToolkitTemplateUrl.app;\n\t\t}\n\t});\n}]);\n\nangular.module('adama-mobile').run([\"$rootScope\", \"pageTitle\", function($rootScope, pageTitle) {\n\t$rootScope.$on('$stateChangeSuccess', function(event, toState) {\n\t\tif (toState && toState.data && toState.data.pageTitle) {\n\t\t\tpageTitle.set(toState.data.pageTitle);\n\t\t}\n\t});\n}]);\n\nangular.module('adama-mobile').config([\"$httpProvider\", function($httpProvider) {\n\t$httpProvider.interceptors.push('authExpiredInterceptor');\n\t$httpProvider.interceptors.push('authInterceptor');\n}]);\n\nangular.module('adama-mobile').run([\"$rootScope\", \"$state\", \"principalService\", function($rootScope, $state, principalService) {\n\t$rootScope.$on('$stateChangeStart', function(event, toState) {\n\t\tif (toState.data && toState.data.authorities && toState.data.authorities.length > 0) {\n\t\t\t// state needs at least one authority\n\t\t\tif (!principalService.isAuthenticated()) {\n\t\t\t\t// send user to the signin state so user can log in\n\t\t\t\t$state.go('auth.signin');\n\t\t\t} else {\n\t\t\t\tif (!principalService.hasAnyAuthority(toState.data.authorities)) {\n\t\t\t\t\t// user is signed in but not authorized for desired state\n\t\t\t\t\t$state.go('auth.accessDenied');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}]);\n\nangular.module('adama-mobile').run([\"$rootScope\", function($rootScope) {\n\t$rootScope.$on('$stateChangeError', function(event, toState, toParams, fromState, fromParams, error) {\n\t\tthrow error;\n\t});\n}]);\n\nangular.module('adama-mobile').run([\"$rootScope\", \"$injector\", \"adamaConstant\", function($rootScope, $injector, adamaConstant) {\n\tvar $ionicPlatform, $cordovaBadge;\n\tif (adamaConstant.enableBadge) {\n\t\t$ionicPlatform = $injector.get('$ionicPlatform');\n\t\t$cordovaBadge = $injector.get('$cordovaBadge');\n\t\t$ionicPlatform.on('resume', function() {\n\t\t\t$cordovaBadge.clear();\n\t\t});\n\n\t\t$ionicPlatform.ready(function() {\n\t\t\t$cordovaBadge.clear();\n\t\t});\n\t}\n}]);\n\nangular.module('adama-mobile').run([\"$rootScope\", \"$injector\", \"$log\", \"adamaConstant\", function($rootScope, $injector, $log, adamaConstant) {\n\tvar log = $log.getInstance('adama-mobile.run.push');\n\tvar $ionicPlatform, $ionicPush, $ionicUser;\n\tif (adamaConstant.enablePush) {\n\t\t$ionicPlatform = $injector.get('$ionicPlatform');\n\t\t$ionicPush = $injector.get('$ionicPush');\n\t\t$ionicUser = $injector.get('$ionicUser');\n\t\t$ionicPlatform.ready(function() {\n\t\t\t$ionicPush.init({\n\t\t\t\tdebug: false,\n\t\t\t\tonNotification: function(notification) {\n\t\t\t\t\t$rootScope.$apply(function() {\n\t\t\t\t\t\t// TODO notification management\n\t\t\t\t\t\tvar payload = $ionicPush.getPayload(notification);\n\t\t\t\t\t\tlog.debug('notification, payload', notification, payload);\n\t\t\t\t\t\t$rootScope.notification = notification;\n\t\t\t\t\t\t$rootScope.payload = payload;\n\t\t\t\t\t\tif (notification.app.asleep || notification.app.closed) {\n\t\t\t\t\t\t\t// $state.go('tab.push');\n\t\t\t\t\t\t\tlog.debug('application was asleep or closed');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonRegister: function(data) {\n\t\t\t\t\tlog.debug('Device token', data.token);\n\t\t\t\t},\n\t\t\t\tcanShowAlert: false,\n\t\t\t\tcanSetBadge: true,\n\t\t\t\tcanPlaySound: true,\n\t\t\t\tcanRunActionsOnWake: true\n\t\t\t});\n\t\t\tif ($ionicUser.current().isAuthenticated()) {\n\t\t\t\t$ionicPush.register(function(data) {\n\t\t\t\t\tlog.debug('register at startup ok', data);\n\t\t\t\t\t$ionicPush.saveToken(data);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$ionicPush.unregister();\n\t\t\t}\n\t\t});\n\t\t$rootScope.$on('ionicuser-new', function() {\n\t\t\t$ionicPush.register(function(data) {\n\t\t\t\tlog.debug('register after signing in ok', data);\n\t\t\t});\n\t\t});\n\t\t$rootScope.$on('principal-remove', function() {\n\t\t\t$ionicPush.unregister();\n\t\t});\n\t}\n}]);\n\nangular.module('adama-mobile').config([\"logEnhancerProvider\", function(logEnhancerProvider) {\n\tlogEnhancerProvider.prefixPattern = '%s::[%s]>';\n\tlogEnhancerProvider.datetimePattern = 'DD/MM/YYYY HH:mm:ss';\n\tlogEnhancerProvider.logLevels = {\n\t\t'*': logEnhancerProvider.LEVEL.OFF\n\t};\n}]);\n","'use strict';\n\nangular.module('adama-mobile').controller('AccessDeniedCtrl', function() {\n\t// nothing to do\n});\n","'use strict';\n\nangular.module('adama-mobile').config([\"$stateProvider\", \"adamaConstant\", function($stateProvider, adamaConstant) {\n\t$stateProvider.state('auth', {\n\t\tabstract: true,\n\t\turl: '/auth',\n\t\ttemplate: '' + //\n\t\t\t'<ui-view></ui-view>' + //\n\t\t\t''\n\t});\n\n\t$stateProvider.state('auth.signin', {\n\t\turl: '/',\n\t\ttemplateUrl: function() {\n\t\t\treturn adamaConstant.adamaMobileToolkitTemplateUrl.authSignin;\n\t\t},\n\t\tcontroller: 'SigninCtrl',\n\t\tcontrollerAs: '$ctrl',\n\t\tdata: {\n\t\t\tpageTitle: 'SIGNIN',\n\t\t\tauthorities: []\n\t\t}\n\t});\n\n\t$stateProvider.state('auth.recoverPassword', {\n\t\turl: '/recoverPassword',\n\t\ttemplateUrl: function() {\n\t\t\treturn adamaConstant.adamaMobileToolkitTemplateUrl.authRecover;\n\t\t},\n\t\tcontroller: 'RecoverPasswordCtrl',\n\t\tcontrollerAs: '$ctrl',\n\t\tdata: {\n\t\t\tpageTitle: 'RECOVER',\n\t\t\tauthorities: []\n\t\t}\n\t});\n\n\t$stateProvider.state('auth.accessDenied', {\n\t\turl: '/accessDenied',\n\t\ttemplateUrl: function() {\n\t\t\treturn adamaConstant.adamaMobileToolkitTemplateUrl.authAccessDenied;\n\t\t},\n\t\tcontroller: 'AccessDeniedCtrl',\n\t\tcontrollerAs: '$ctrl',\n\t\tdata: {\n\t\t\tpageTitle: 'ACCESS_DENIED',\n\t\t\tauthorities: []\n\t\t}\n\t});\n}]);\n\nangular.module('adama-mobile').config([\"$translateProvider\", function($translateProvider) {\n\t$translateProvider.translations('fr', {\n\t\t'SIGNIN': 'Identification',\n\t\t'SIGNIN_INTRO': 'Identifiez-vous pour démarrer votre session',\n\t\t'SIGNIN_FORGET_PASSWORD': 'J\\'ai oublié mon mot de passe ...',\n\t\t'SIGNIN_USERNAME': 'Identifiant',\n\t\t'SIGNIN_USERNAME_REQUIRED': 'L\\'identifiant est obligatoire',\n\t\t'SIGNIN_PASSWORD': 'Mot de passe',\n\t\t'SIGNIN_PASSWORD_REQUIRED': 'Le mot de passe est obligatoire',\n\t\t'SIGNIN_SUBMIT': 'Démarrer la session',\n\t\t'SIGNIN_LOADING': 'Données en cours de chargement',\n\t\t'SIGNIN_ERROR_TITLE': 'Erreur d\\'authentification',\n\t\t'SIGNIN_ERROR_MESSAGE': 'Identifiant ou mot de passe incorrect.',\n\t\t'RECOVER': 'Récupération de mot de passe',\n\t\t'RECOVER_INTRO': 'Saisissez votre email pour récupérer votre mot de passe',\n\t\t'RECOVER_MAIL': 'Email',\n\t\t'RECOVER_MAIL_REQUIRED': 'L\\'email est obligatoire',\n\t\t'RECOVER_MAIL_EMAIL': 'L\\'email n\\'est pas au bon format',\n\t\t'RECOVER_SUBMIT': 'Récupérer mon mot de passe',\n\t\t'RECOVER_BACK_TO_LOGIN': 'Retour à l\\'identificaition',\n\t\t'RECOVER_SUCCESS': 'Consultez votre email pour connaître comment réinitialiser votre mot de passe.',\n\t\t'RECOVER_ERROR_TITLE': 'Erreur',\n\t\t'RECOVER_ERROR_GENERIC': 'Erreur lors de la récupération du mot de passe.',\n\t\t'RECOVER_ERROR_EMAIL_NOT_EXIST': 'L\\'email n\\'existe pas',\n\t\t'ACCESS_DENIED_BACK_TO_HOME': 'Retour à l\\'accueil',\n\t\t'ACCESS_DENIED': 'Accès interdit',\n\t\t'ACCESS_DENIED_INTRO': 'Vous n\\'avez pas suffisamment de droits d\\'accéder à cette page.'\n\t});\n\n\t$translateProvider.translations('en', {\n\t\t'SIGNIN': 'Signin',\n\t\t'SIGNIN_INTRO': 'Sign in to start your session',\n\t\t'SIGNIN_FORGET_PASSWORD': 'I forgot my password ...',\n\t\t'SIGNIN_USERNAME': 'Username',\n\t\t'SIGNIN_USERNAME_REQUIRED': 'Username is required',\n\t\t'SIGNIN_PASSWORD': 'Password',\n\t\t'SIGNIN_PASSWORD_REQUIRED': 'Password is required',\n\t\t'SIGNIN_SUBMIT': 'Start session',\n\t\t'SIGNIN_LOADING': 'Loading user informations',\n\t\t'SIGNIN_ERROR_TITLE': 'Authentication error',\n\t\t'SIGNIN_ERROR_MESSAGE': 'Username or password are incorrect.',\n\t\t'RECOVER': 'Recover password',\n\t\t'RECOVER_INTRO': 'Set your email to recover your password',\n\t\t'RECOVER_MAIL': 'Email',\n\t\t'RECOVER_MAIL_REQUIRED': 'Email is required',\n\t\t'RECOVER_MAIL_EMAIL': 'Email does not respect the right format',\n\t\t'RECOVER_SUBMIT': 'Retrieve my password',\n\t\t'RECOVER_BACK_TO_LOGIN': 'Back to signin',\n\t\t'RECOVER_SUCCESS': 'Check your e-mails for details on how to reset your password.',\n\t\t'RECOVER_ERROR_TITLE': 'Error',\n\t\t'RECOVER_ERROR_GENERIC': 'Recovering error.',\n\t\t'RECOVER_ERROR_EMAIL_NOT_EXIST': 'E-Mail address isn\\'t registered! Please check and try again',\n\t\t'ACCESS_DENIED_BACK_TO_HOME': 'Back to home',\n\t\t'ACCESS_DENIED': 'Access denied',\n\t\t'ACCESS_DENIED_INTRO': 'You do not have enough privileges to access this page.'\n\t});\n}]);\n","'use strict';\n\nangular.module('adama-mobile').controller('RecoverPasswordCtrl', [\"$filter\", \"$ionicPopup\", \"principalService\", function($filter, $ionicPopup, principalService) {\n\tvar ctrl = this;\n\tctrl.recover = function(userEmail) {\n\t\tctrl.recoverSuccess = false;\n\t\tctrl.recoverError = false;\n\t\tctrl.errorEmailNotExists = false;\n\t\tctrl.loading = true;\n\t\tprincipalService.resetPasswordInit(userEmail).then(function() {\n\t\t\tctrl.recoverSuccess = true;\n\t\t}).catch(function(response) {\n\t\t\tvar messageKey = 'RECOVER_ERROR_GENERIC';\n\t\t\tif (response.status === 400 && response.data === 'e-mail address not registered') {\n\t\t\t\tmessageKey = 'RECOVER_ERROR_EMAIL_NOT_EXIST';\n\t\t\t}\n\t\t\tvar translateFn = $filter('translate');\n\t\t\t$ionicPopup.alert({\n\t\t\t\ttitle: translateFn('RECOVER_ERROR_TITLE'),\n\t\t\t\ttemplate: translateFn(messageKey)\n\t\t\t});\n\t\t}).finally(function() {\n\t\t\tctrl.loading = false;\n\t\t});\n\t};\n}]);\n","'use strict';\n\nangular.module('adama-mobile').controller('SigninCtrl', [\"$rootScope\", \"$state\", \"$log\", \"authService\", \"$filter\", \"$ionicPopup\", function($rootScope, $state, $log, authService, $filter, $ionicPopup) {\n\tvar log = $log.getInstance('adama-mobile.auth.signin');\n\tvar ctrl = this;\n\tctrl.loading = false;\n\tctrl.signin = function(userName, userPassword) {\n\t\tctrl.loading = true;\n\t\tauthService.login(userName, userPassword).then(function() {\n\t\t\tlog.debug('user is logged, rediret to app.main');\n\t\t\t$state.go('app.main');\n\t\t\tctrl.loading = false;\n\t\t}).catch(function(rejection) {\n\t\t\tlog.info('error while signing in', rejection);\n\t\t\tctrl.rejection = rejection;\n\t\t\tvar translateFn = $filter('translate');\n\t\t\t$ionicPopup.alert({\n\t\t\t\ttitle: translateFn('SIGNIN_ERROR_TITLE'),\n\t\t\t\ttemplate: translateFn('SIGNIN_ERROR_MESSAGE')\n\t\t\t});\n\t\t\tctrl.loading = false;\n\t\t});\n\t};\n}]);\n","'use strict';\n\nangular.module('adama-mobile').config([\"$translateProvider\", function($translateProvider) {\n\t$translateProvider.translations('fr', {\n\t\t'BTN_SIGNOUT': 'Déconnexion'\n\t});\n\n\t$translateProvider.translations('en', {\n\t\t'BTN_SIGNOUT': 'Sign out'\n\t});\n}]);\n","'use strict';\n\nangular.module('adama-mobile').component('btnSignout', {\n\ttemplateUrl: 'adama-mobile/btn-signout/btn-signout.html',\n\tcontroller: [\"authService\", \"$state\", function(authService, $state) {\n\t\tvar ctrl = this;\n\t\tctrl.signout = function() {\n\t\t\tauthService.logout();\n\t\t\t$state.go('auth.signin');\n\t\t};\n\t}]\n});\n","'use strict';\n\nangular.module('adama-mobile').directive('dsBinaryFileUrl', [\"$parse\", \"binaryFileService\", function($parse, binaryFileService) {\n\treturn {\n\t\tscope: false,\n\t\tlink: function(scope, element, attrs) {\n\t\t\tvar updateOutput = function(binaryFileList) {\n\t\t\t\tif (attrs.output) {\n\t\t\t\t\tbinaryFileList = angular.copy(binaryFileList);\n\t\t\t\t}\n\t\t\t\tif (!angular.isArray(binaryFileList)) {\n\t\t\t\t\tbinaryFileList = [binaryFileList];\n\t\t\t\t}\n\t\t\t\tbinaryFileService.initUrlForBinaryFiles(binaryFileList).then(function() {\n\t\t\t\t\tif (attrs.output) {\n\t\t\t\t\t\t$parse(attrs.output).assign(scope, binaryFileList);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t\tscope.$watch(attrs.input, function() {\n\t\t\t\tvar binaryFileList = $parse(attrs.input)(scope);\n\t\t\t\tif (binaryFileList) {\n\t\t\t\t\tupdateOutput(binaryFileList);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}]);\n","'use strict';\n\nangular.module('adama-mobile').directive('dsLanguage', [\"$parse\", \"language\", function($parse, language) {\n\treturn {\n\t\tscope: false,\n\t\tlink: function(scope, element, attrs) {\n\t\t\tlanguage.getAll().then(function(languages) {\n\t\t\t\t$parse(attrs.data).assign(scope, languages);\n\t\t\t});\n\t\t}\n\t};\n}]);\n","'use strict';\n\nangular.module('adama-mobile').directive('dsPrincipalIdentity', [\"$rootScope\", \"$parse\", \"principalService\", function($rootScope, $parse, principalService) {\n\treturn {\n\t\tscope: false,\n\t\tlink: function(scope, element, attrs) {\n\t\t\t$rootScope.$on('principal-new', function(event, data) {\n\t\t\t\t$parse(attrs.data).assign(scope, data.principal);\n\t\t\t});\n\t\t\t$rootScope.$on('principal-remove', function() {\n\t\t\t\t$parse(attrs.data).assign(scope, undefined);\n\t\t\t});\n\t\t\tprincipalService.getPrincipal().then(function(principal) {\n\t\t\t\t$parse(attrs.data).assign(scope, principal);\n\t\t\t});\n\t\t}\n\t};\n}]);\n","/*jshint -W069 */\n/*jscs:disable requireDotNotation*/\n'use strict';\n\nangular.module('adama-mobile').factory('authExpiredInterceptor', [\"$injector\", \"$q\", \"$log\", \"adamaConstant\", function($injector, $q, $log, adamaConstant) {\n\tvar getHttpService = (function() {\n\t\tvar service;\n\t\treturn function() {\n\t\t\treturn service || (service = $injector.get('$http'));\n\t\t};\n\t}());\n\n\tvar getAdamaTokenService = (function() {\n\t\tvar service;\n\t\treturn function() {\n\t\t\treturn service || (service = $injector.get('adamaTokenService'));\n\t\t};\n\t}());\n\n\tvar getStateService = (function() {\n\t\tvar service;\n\t\treturn function() {\n\t\t\treturn service || (service = $injector.get('$state'));\n\t\t};\n\t}());\n\n\treturn {\n\t\tresponseError: function(response) {\n\t\t\tvar config = response.config;\n\t\t\tif (response.status === 401 && config.url.indexOf(adamaConstant.apiBase) === 0) {\n\t\t\t\tvar log = $log.getInstance('adama-mobile.interceptors.authExpiredInterceptor');\n\t\t\t\tlog.debug('error 401, refresh token', config.url);\n\t\t\t\treturn getAdamaTokenService().refreshAndGetToken().then(function() {\n\t\t\t\t\tlog.debug('token is refresh, reset Authorization header');\n\t\t\t\t\tconfig.headers['Authorization'] = undefined;\n\t\t\t\t\treturn getHttpService()(config);\n\t\t\t\t}, function(rejection) {\n\t\t\t\t\treturn getStateService().go('auth.signin').then(function() {\n\t\t\t\t\t\tlog.debug('error while getting user token', rejection);\n\t\t\t\t\t\treturn $q.reject(rejection);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn $q.reject(response);\n\t\t}\n\t};\n}]);\n","/*jshint -W069 */\n/*jscs:disable requireDotNotation*/\n'use strict';\n\nangular.module('adama-mobile').factory('authInterceptor', [\"$injector\", \"$q\", \"$log\", \"adamaConstant\", function($injector, $q, $log, adamaConstant) {\n\tvar getAdamaTokenService = (function() {\n\t\tvar service;\n\t\treturn function() {\n\t\t\treturn service || (service = $injector.get('adamaTokenService'));\n\t\t};\n\t}());\n\n\tvar getStateService = (function() {\n\t\tvar service;\n\t\treturn function() {\n\t\t\treturn service || (service = $injector.get('$state'));\n\t\t};\n\t}());\n\n\treturn {\n\t\t// Add authorization token to headers\n\t\trequest: function(config) {\n\t\t\tvar log = $log.getInstance('adama-mobile.interceptors.authInterceptor');\n\t\t\tlog.debug('url', config.url);\n\t\t\tconfig.headers = config.headers || {};\n\t\t\tif (!config.headers['Authorization'] && config.url.indexOf(adamaConstant.apiBase) === 0) {\n\t\t\t\tlog.debug('need authorization, getting token');\n\t\t\t\treturn getAdamaTokenService().getToken().then(function(token) {\n\t\t\t\t\tlog.debug('adding Authorization header', token);\n\t\t\t\t\tif (token) {\n\t\t\t\t\t\tconfig.headers['Authorization'] = 'Bearer ' + token;\n\t\t\t\t\t}\n\t\t\t\t\treturn config;\n\t\t\t\t}, function(rejection) {\n\t\t\t\t\treturn getStateService().go('auth.signin').then(function() {\n\t\t\t\t\t\tlog.debug('error while getting user token', rejection);\n\t\t\t\t\t\treturn $q.reject(rejection);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn config;\n\t\t}\n\t};\n}]);\n","'use strict';\n\nangular.module('adama-mobile').factory('User', [\"$resource\", \"adamaConstant\", \"adamaResourceConfig\", function($resource, adamaConstant, adamaResourceConfig) {\n\tvar config = angular.extend({}, adamaResourceConfig, {\n\t\t'delete': {\n\t\t\tmethod: 'DELETE',\n\t\t\tparams: {\n\t\t\t\tid: '@id'\n\t\t\t}\n\t\t}\n\t});\n\treturn $resource(adamaConstant.apiBase + 'users/:id', {}, config);\n}]);\n","'use strict';\n\nangular.module('adama-mobile').factory('adamaResourceConfig', [\"ParseLinks\", function(ParseLinks) {\n\treturn {\n\t\t'query': {\n\t\t\tmethod: 'GET',\n\t\t\tisArray: true,\n\t\t\ttransformResponse: function(data, headers, status) {\n\t\t\t\tdata = angular.fromJson(data);\n\t\t\t\tif (status === 200) {\n\t\t\t\t\tdata.$metadata = {\n\t\t\t\t\t\tlinks: ParseLinks.parse(headers('link')),\n\t\t\t\t\t\ttotalItems: headers('X-Total-Count')\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn data;\n\t\t\t},\n\t\t\tinterceptor: {\n\t\t\t\tresponse: function(response) {\n\t\t\t\t\tresponse.resource.$metadata = response.data.$metadata;\n\t\t\t\t\treturn response.resource;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t'get': {\n\t\t\tmethod: 'GET'\n\t\t},\n\t\t'save': {\n\t\t\tmethod: 'POST'\n\t\t},\n\t\t'update': {\n\t\t\tmethod: 'PUT'\n\t\t},\n\t\t'delete': {\n\t\t\tmethod: 'DELETE',\n\t\t\tparams: {\n\t\t\t\tid: '@id'\n\t\t\t}\n\t\t}\n\t};\n}]);\n","/* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */\n/* jshint camelcase:false */\n\n'use strict';\n\nangular.module('adama-mobile').factory('adamaTokenService', [\"$rootScope\", \"$http\", \"$q\", \"$state\", \"$ionicUser\", \"$log\", \"jwtHelper\", \"adamaConstant\", function($rootScope, $http, $q, $state, $ionicUser, $log, jwtHelper, adamaConstant) {\n\tvar log = $log.getInstance('adama-mobile.services.adamaTokenService');\n\tvar api = {};\n\n\tvar ionicUser = $ionicUser.current();\n\t$rootScope.$on('ionicuser-new', function() {\n\t\tlog.debug('update ionicUser');\n\t\tionicUser = $ionicUser.current();\n\t});\n\n\tapi.getToken = function() {\n\t\tlog.debug('getToken');\n\t\tvar token;\n\t\tif (ionicUser.isAuthenticated()) {\n\t\t\tlog.debug('getToken user is authenticated');\n\t\t\ttoken = ionicUser.get('access_token');\n\t\t\tif (token && jwtHelper.isTokenExpired(token)) {\n\t\t\t\tlog.debug('getToken token is expired');\n\t\t\t\treturn api.refreshAndGetToken();\n\t\t\t}\n\t\t}\n\t\treturn $q.when(token);\n\t};\n\n\tapi.refreshAndGetToken = function() {\n\t\tlog.debug('refreshAndGetToken');\n\t\tvar token = ionicUser.get('access_token');\n\t\tif (!token) {\n\t\t\t// FIXME should not occur as ionicUser should always have a\n\t\t\t// access_token\n\t\t\tlog.info('no token, redirect to signin');\n\t\t\tlog.debug('for debugging purpose, here is the ionic current user', ionicUser);\n\t\t\tlog.debug('for debugging purpose, here is the ionic current user.isAuthenticated', ionicUser.isAuthenticated());\n\t\t\tlog.debug('for debugging purpose, here is a JSON.stringify version of ionic current user', JSON.stringify(ionicUser));\n\t\t\treturn $q.reject('refreshAndGetToken : no token !!!!');\n\t\t}\n\t\tlog.debug('refreshAndGetToken token', token);\n\t\tvar refreshToken = ionicUser.get('refresh_token');\n\t\tlog.debug('refreshAndGetToken refreshToken', refreshToken);\n\t\treturn $http({\n\t\t\tmethod: 'POST',\n\t\t\turl: adamaConstant.apiBase + 'login/refresh',\n\t\t\theaders: {\n\t\t\t\t'Authorization': 'Bearer ' + token\n\t\t\t},\n\t\t\tdata: {\n\t\t\t\t'refresh_token': refreshToken\n\t\t\t}\n\t\t}).then(function(response) {\n\t\t\tvar newToken = response.data.access_token;\n\t\t\tlog.debug('refreshAndGetToken newToken', newToken);\n\t\t\tionicUser.set('access_token', newToken);\n\t\t\treturn ionicUser.save().then(function() {\n\t\t\t\treturn newToken;\n\t\t\t});\n\t\t}, function(rejection) {\n\t\t\tlog.info('error while refreshing user token, redirect to signin', rejection);\n\t\t\treturn $q.reject(rejection);\n\t\t});\n\t};\n\n\treturn api;\n}]);\n","'use strict';\n\nangular.module('adama-mobile').constant('adamaConstant', {\n\tapiBase: 'http://localhost:13337/',\n\tadamaMobileToolkitTemplateUrl: {\n\t\tapp: 'adama-mobile/app.html',\n\t\tauthAccessDenied: 'adama-mobile/auth/accessDenied.html',\n\t\tauthSignin: 'adama-mobile/auth/signin.html',\n\t\tauthRecover: 'adama-mobile/auth/recoverPassword.html'\n\t},\n\tenableBadge: false,\n\tenablePush: false,\n\turlResetPassword: 'path/to/reset/password?origin=mobile'\n});\n","'use strict';\n\nangular.module('adama-mobile').factory('authService', [\"$rootScope\", \"$http\", \"$ionicAuth\", \"$log\", \"adamaConstant\", \"principalService\", function($rootScope, $http, $ionicAuth, $log, adamaConstant, principalService) {\n\tvar log = $log.getInstance('adama-mobile.services.authService');\n\tvar api = {};\n\n\tapi.login = function(username, password) {\n\t\tlog.debug('login', username);\n\t\tvar authOptions = {\n\t\t\tremember: true\n\t\t};\n\t\tvar data = {\n\t\t\tusername: username,\n\t\t\tpassword: password\n\t\t};\n\t\treturn $ionicAuth.login('custom', authOptions, data).then(function() {\n\t\t\tlog.debug('login is ok, ask custom auth server to refresh the user data');\n\t\t\treturn $http({\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: adamaConstant.apiBase + 'externalLogin/refreshUserExternal',\n\t\t\t\tdata: {\n\t\t\t\t\texternalId: username\n\t\t\t\t}\n\t\t\t});\n\t\t}).then(function() {\n\t\t\tlog.debug('refreshing custom auth server is ok, ask the backend for the updated user info');\n\t\t\t$rootScope.$broadcast('ionicuser-new');\n\t\t\t// get the new user information from ionic\n\t\t\treturn principalService.resetPrincipal();\n\t\t}).then(function() {\n\t\t\tlog.debug('user is logged in in both ionic and backend');\n\t\t});\n\t};\n\n\tapi.logout = function() {\n\t\tlog.debug('logout');\n\t\t$ionicAuth.logout();\n\t\tprincipalService.deletePrincipal();\n\t};\n\n\treturn api;\n}]);\n","'use strict';\n\nangular.module('adama-mobile').factory('binaryFileService', [\"$http\", \"$q\", \"adamaConstant\", function($http, $q, adamaConstant) {\n\tvar api = {};\n\n\tapi.initUrlForBinaryFiles = function(binaryFileList) {\n\t\tvar workingList = [];\n\t\tvar idList = [];\n\t\tangular.forEach(binaryFileList, function(binaryFile) {\n\t\t\tif (binaryFile && binaryFile.id && !binaryFile.url) {\n\t\t\t\tworkingList.push(binaryFile);\n\t\t\t\tidList.push(binaryFile.id);\n\t\t\t}\n\t\t});\n\t\tif (idList.length) {\n\t\t\treturn $http({\n\t\t\t\tmethod: 'PUT',\n\t\t\t\turl: adamaConstant.apiBase + 'files',\n\t\t\t\tdata: angular.toJson(idList)\n\t\t\t}).then(function(response) {\n\t\t\t\tangular.forEach(workingList, function(binaryFile) {\n\t\t\t\t\tbinaryFile.url = response.data.urlList[binaryFile.id];\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn $q.when();\n\t};\n\n\treturn api;\n}]);\n","'use strict';\n\nangular.module('adama-mobile').provider('language', function() {\n\tvar languages = ['en', 'fr'];\n\tvar selectorData = [{\n\t\tcode: 'en',\n\t\tlabelKey: 'FLAG_EN',\n\t\tcssCLass: 'us'\n\t}, {\n\t\tcode: 'fr',\n\t\tlabelKey: 'FLAG_FR',\n\t\tcssCLass: 'fr'\n\t}];\n\n\tthis.setLanguages = function(newLanguages) {\n\t\tlanguages = newLanguages;\n\t};\n\n\tthis.setSelectorData = function(newSelectorData) {\n\t\tselectorData = newSelectorData;\n\t};\n\n\tthis.$get = [\"$q\", \"$http\", \"$translate\", function($q, $http, $translate) {\n\t\tvar api = {};\n\n\t\tapi.getCurrent = function() {\n\t\t\tvar language = $translate.storage().get('NG_TRANSLATE_LANG_KEY');\n\t\t\tif (angular.isUndefined(language)) {\n\t\t\t\tlanguage = 'en';\n\t\t\t}\n\t\t\treturn $q.when(language);\n\t\t};\n\n\t\tapi.getAll = function() {\n\t\t\treturn $q.when(languages);\n\t\t};\n\n\t\tapi.getSelectorData = function() {\n\t\t\treturn $q.when(selectorData);\n\t\t};\n\n\t\treturn api;\n\t}];\n});\n","'use strict';\n\nangular.module('adama-mobile').factory('loadingService', [\"$filter\", \"$ionicLoading\", function($filter, $ionicLoading) {\n\tvar api = {};\n\tvar translateFn = $filter('translate');\n\n\tapi.blockUiWhileResolving = function(messageKey, promise) {\n\t\tif (promise.$$state.status === 0) {\n\t\t\t$ionicLoading.show({\n\t\t\t\ttemplate: translateFn(messageKey)\n\t\t\t});\n\t\t}\n\t\treturn promise.finally(function() {\n\t\t\t$ionicLoading.hide();\n\t\t});\n\t};\n\n\treturn api;\n}]);\n","'use strict';\n\nangular.module('adama-mobile').factory('notificationsService', [\"$filter\", \"$cordovaToast\", \"$log\", function($filter, $cordovaToast, $log) {\n\tvar log = $log.getInstance('adama-mobile.services.notificationsService');\n\tvar api = {};\n\tvar translateFn = $filter('translate');\n\n\tapi.show = function(messageKey) {\n\t\tlog.debug('show', messageKey);\n\t\treturn $cordovaToast.show(translateFn(messageKey), 'short', 'bottom');\n\t};\n\n\treturn api;\n}]);\n","'use strict';\n\nangular.module('adama-mobile').factory('pageTitle', [\"$rootScope\", \"$filter\", function($rootScope, $filter) {\n\tvar translateFn = $filter('translate');\n\tvar api = {};\n\n\tapi.set = function(pageTitleKey, data) {\n\t\tvar newTitle = translateFn(pageTitleKey, data);\n\t\t$rootScope.pageTitle = newTitle;\n\t};\n\n\treturn api;\n}]);\n","'use strict';\n\nangular.module('adama-mobile').service('ParseLinks', function() {\n\tthis.parse = function(header) {\n\t\tif (header.length === 0) {\n\t\t\tthrow new Error('input must not be of zero length');\n\t\t}\n\n\t\t// Split parts by comma\n\t\tvar parts = header.split(',');\n\t\tvar links = {};\n\t\t// Parse each part into a named link\n\t\tangular.forEach(parts, function(p) {\n\t\t\tvar section = p.split(';');\n\t\t\tif (section.length !== 2) {\n\t\t\t\tthrow new Error('section could not be split on \";\"');\n\t\t\t}\n\t\t\tvar url = section[0].replace(/<(.*)>/, '$1').trim();\n\t\t\tvar queryString = {};\n\t\t\turl.replace(new RegExp('([^?=&]+)(=([^&]*))?', 'g'), function($0, $1, $2, $3) {\n\t\t\t\tqueryString[$1] = $3;\n\t\t\t});\n\t\t\tvar page = queryString.page;\n\t\t\tif (angular.isString(page)) {\n\t\t\t\tpage = parseInt(page);\n\t\t\t}\n\t\t\tvar name = section[1].replace(/rel='(.*)'/, '$1').trim();\n\t\t\tlinks[name] = page;\n\t\t});\n\n\t\treturn links;\n\t};\n});\n","/*jshint -W069 */\n/*jscs:disable requireDotNotation*/\n'use strict';\n\nangular.module('adama-mobile').factory('principalService', [\"$rootScope\", \"$q\", \"$http\", \"$resource\", \"$state\", \"$ionicUser\", \"$log\", \"adamaConstant\", function($rootScope, $q, $http, $resource, $state, $ionicUser, $log, adamaConstant) {\n\tvar log = $log.getInstance('adama-mobile.services.principalService');\n\tvar api = {};\n\tvar principalPromise;\n\tvar ionicUser = $ionicUser.current();\n\tvar isAuthenticated = ionicUser.isAuthenticated();\n\tvar accountResource = $resource(adamaConstant.apiBase + 'account', {}, {});\n\tvar passwordResource = $resource(adamaConstant.apiBase + 'account/change_password', {}, {});\n\tvar passwordResetInitResource = $resource(adamaConstant.apiBase + 'account/reset_password/init', {}, {});\n\n\tapi.isAuthenticated = function() {\n\t\treturn isAuthenticated;\n\t};\n\n\tapi.resetPrincipal = function() {\n\t\tvar result;\n\t\tionicUser = $ionicUser.current();\n\t\tisAuthenticated = ionicUser.isAuthenticated();\n\t\tlog.debug('resetPrincipal');\n\t\tlog.debug('resetPrincipal ionicUser', ionicUser);\n\t\tlog.debug('resetPrincipal isAuthenticated', isAuthenticated);\n\t\tif (isAuthenticated) {\n\t\t\tvar externalId = ionicUser.details['external_id'];\n\t\t\tif (!externalId) {\n\t\t\t\t// FIXME should not occur, every ionicuser should have an\n\t\t\t\t// external_id\n\t\t\t\tlog.info('no external_id, redirect to signin');\n\t\t\t\tresult = $q.reject('resetPrincipal : no external_id');\n\t\t\t} else {\n\t\t\t\tprincipalPromise = $http({\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\turl: adamaConstant.apiBase + 'users/byLogin/' + externalId\n\t\t\t\t}).then(function(response) {\n\t\t\t\t\tvar principal = response.data;\n\t\t\t\t\tisAuthenticated = true;\n\t\t\t\t\t$rootScope.$broadcast('principal-new', {\n\t\t\t\t\t\tprincipal: principal\n\t\t\t\t\t});\n\t\t\t\t\treturn principal;\n\t\t\t\t});\n\t\t\t\tresult = principalPromise;\n\t\t\t}\n\t\t} else {\n\t\t\tlog.info('user is not authenticated');\n\t\t\tresult = $q.reject('resetPrincipal : not authenticated');\n\t\t}\n\t\treturn result.catch(function(rejection) {\n\t\t\tlog.debug('there was a problem while reseting user info, redirect to signin');\n\t\t\tisAuthenticated = false;\n\t\t\tprincipalPromise = undefined;\n\t\t\t$state.go('auth.signin');\n\t\t\treturn $q.reject(rejection);\n\t\t});\n\t};\n\n\tapi.getPrincipal = function() {\n\t\tif (!principalPromise) {\n\t\t\treturn api.resetPrincipal();\n\t\t}\n\t\treturn principalPromise;\n\t};\n\n\tapi.deletePrincipal = function() {\n\t\tisAuthenticated = false;\n\t\tprincipalPromise = undefined;\n\t\t$rootScope.$broadcast('principal-remove');\n\t};\n\n\tapi.hasAnyAuthority = function(authorities) {\n\t\tlog.debug('hasAnyAuthority', authorities);\n\t\t// TODO\n\t\treturn true;\n\t};\n\n\tapi.resetPasswordInit = function(mail) {\n\t\tlog.debug('resetPasswordInit', mail);\n\t\treturn passwordResetInitResource.save({\n\t\t\tmail: mail,\n\t\t\turlResetPassword: adamaConstant.urlResetPassword\n\t\t}).$promise;\n\t};\n\n\tapi.updateAccount = function(principal) {\n\t\tlog.debug('updateAccount', principal);\n\t\treturn accountResource.save(principal, function() {\n\t\t\t$rootScope.$emit('principal-update', {\n\t\t\t\tprincipal: principal\n\t\t\t});\n\t\t\tprincipalPromise = $q.when(principal);\n\t\t}).$promise;\n\t};\n\n\tapi.changePassword = function(newPassword) {\n\t\tlog.debug('changePassword');\n\t\treturn passwordResource.save({\n\t\t\tpassword: newPassword\n\t\t}).$promise;\n\t};\n\n\treturn api;\n}]);\n"],"sourceRoot":"/source/"}